"use strict";function zoom(e,t){e=void 0!==e&&Object.keys(e).length?e:{};for(var n,i,s,a,l,r,o,u,c,d,m,v,h,f,b,g,p,w,A,E,M,x,L,S,C,D,F,W,y,R,T,Y,H=(t=void 0!==t&&Object.keys(t).length?t:{}).scaleDefault||2,X=t.scaleDifference||.5,k=t.scaleMax||10,z=t.scaleMin||1,N=e.active||"active",B="data-scale",O="data-translate-x",K="data-translate-y",j=e.transition||"transition",q=e.visible||"visible",V=document.getElementsByClassName(e.zoom||"zoom"),G=!1,I=[null],J=0,P=!1,Q=0,U=[null],Z=0;Z<V.length;Z++)n=V[Z],(i=n.children[0]).setAttribute(B,1),i.setAttribute(O,0),i.setAttribute(K,0);window.addEventListener("load",function(){for(var e=0;e<V.length;e++)n=V[e],addClass(i=n.children[0],q);window.addEventListener("resize",function(){for(var e=0;e<V.length;e++)n=V[e],i=n.children[0],!1!==hasClass(n,N)&&(s=n.clientHeight,a=n.clientWidth,u=i.clientHeight,c=i.clientWidth,d=parseFloat(i.getAttribute(O)),m=parseFloat(i.getAttribute(K)),p=(c*(T=H)-a)/2,w=(u*T-s)/2,W=c*T>a?minMax(d,-1*p,p):0,y=u*T>s?minMax(m,-1*w,w):0,1===T&&removeClass(n,N),i.setAttribute(B,T),i.setAttribute(O,W),i.setAttribute(K,y),moveScaleElement(i,W+"px",y+"px",T))})}),window.addEventListener("scroll",function(){window.lastScrollTime=(new Date).getTime()}),massAddEventListener(V,"mousedown",function(e){if(e.preventDefault(),!0===P||1!==e.which)return!1;if(n=this,i=this.children[0],h=e.clientX,b=e.clientY,null===I[0])I[0]=e.target,I[1]=h,I[2]=b,setTimeout(function(){I=[null]},300);else if(I[0]===e.target&&J<=5&&!0===isWithinRange(h,I[1]-10,I[1]+10)&&!0===isWithinRange(b,I[2]-10,I[2]+10))return addClass(i,j),!0===hasClass(n,N)?(i.setAttribute(B,1),i.setAttribute(O,0),i.setAttribute(K,0),removeClass(n,N),moveScaleElement(i,0,0,1)):(i.setAttribute(B,H),i.setAttribute(O,0),i.setAttribute(K,0),addClass(n,N),moveScaleElement(i,0,0,H)),setTimeout(function(){removeClass(i,j)},200),I=[null],!1;A=n.getBoundingClientRect(),l=A.left,r=A.top,s=n.clientHeight,a=n.clientWidth,u=i.clientHeight,c=i.clientWidth,d=parseFloat(i.getAttribute(O)),m=parseFloat(i.getAttribute(K)),o=minMax(parseFloat(i.getAttribute(B)),z,k),J=0,G=!0}),massAddEventListener(V,"mouseenter",function(){P||disableScroll()}),massAddEventListener(V,"mouseleave",function(){P||enableScroll()}),document.addEventListener("mousemove",function(e){if(!0===P||!1===G)return!1;x=e.clientX,S=e.clientY,p=(c*(T=o)-a)/2,w=(u*T-s)/2,W=c*T<=a?0:minMax(x-(h-d),-1*p,p),y=u*T<=s?0:minMax(S-(b-m),-1*w,w),J++,Math.abs(W)===Math.abs(p)&&(d=W,h=x);Math.abs(y)===Math.abs(w)&&(m=y,b=S);i.setAttribute(B,T),i.setAttribute(O,W),i.setAttribute(K,y),moveScaleElement(i,W+"px",y+"px",T)}),document.addEventListener("mouseup",function(){if(!0===P||!1===G)return!1;G=!1}),document.addEventListener("touchstart",function(){isScrolling()||T&&!(T<=z)||(P=!0)}),massAddEventListener(V,"touchstart",function(e){if(isScrolling())return!1;if(1==e.touches.length&&(!T||T<=z))return!1;if(e.touches.length>2)return!1;if(e.preventDefault(),n=this,i=this.children[0],A=n.getBoundingClientRect(),l=A.left,r=A.top,s=n.clientHeight,a=n.clientWidth,u=i.clientHeight,c=i.clientWidth,h=e.touches[0].clientX,b=e.touches[0].clientY,o=minMax(parseFloat(i.getAttribute(B)),z,k),1===(Y=e.touches.length)){if(null===U[0])U[0]=e.target,U[1]=h,U[2]=b,setTimeout(function(){U=[null]},300);else if(U[0]===e.target&&Q<=1&&!0===isWithinRange(h,U[1]-10,U[1]+10)&&!0===isWithinRange(b,U[2]-10,U[2]+10))return addClass(i,j),!0===hasClass(n,N)?(i.setAttribute(B,1),i.setAttribute(O,0),i.setAttribute(K,0),removeClass(n,N),moveScaleElement(i,0,0,1)):(i.setAttribute(B,H),i.setAttribute(O,0),i.setAttribute(K,0),addClass(n,N),moveScaleElement(i,0,0,H)),setTimeout(function(){removeClass(i,j)},200),U=[null],!1;d=parseFloat(i.getAttribute(O)),m=parseFloat(i.getAttribute(K))}else 2===Y&&(d=parseFloat(i.getAttribute(O)),m=parseFloat(i.getAttribute(K)),f=e.touches[1].clientX,g=e.touches[1].clientY,E=(h+f)/2,M=(b+g)/2,v=Math.sqrt((h-f)*(h-f)+(b-g)*(b-g)));Q=0,G=!0}),document.addEventListener("touchmove",function(e){if(!1===G)return!1;x=e.touches[0].clientX,S=e.touches[0].clientY,Y=e.touches.length,Q++,Y>1?(L=e.touches[1].clientX,C=e.touches[1].clientY,R=Math.sqrt((x-L)*(x-L)+(S-C)*(S-C)),null===v&&(v=R),Math.abs(v-R)>=1&&(T=minMax(R/v*o,z,k),p=(c*T-a)/2,w=(u*T-s)/2,F=T-o,W=c*T<=a?0:minMax(d-(E-l-a/2-d)/(T-F)*F,-1*p,p),y=u*T<=s?0:minMax(m-(M-r-s/2-m)/(T-F)*F,-1*w,w),T>1?addClass(n,N):removeClass(n,N),moveScaleElement(i,W+"px",y+"px",T),v=R,o=T,d=W,m=y)):(p=(c*(T=o)-a)/2,w=(u*T-s)/2,W=c*T<=a?0:minMax(x-(h-d),-1*p,p),y=u*T<=s?0:minMax(S-(b-m),-1*w,w),Math.abs(W)===Math.abs(p)&&(d=W,h=x),Math.abs(y)===Math.abs(w)&&(m=y,b=S),i.setAttribute(B,o),i.setAttribute(O,W),i.setAttribute(K,y),moveScaleElement(i,W+"px",y+"px",T))}),document.addEventListener("touchend",function(e){if(Y=e.touches.length,!1===G)return!1;0===Y?(i.setAttribute(B,o),i.setAttribute(O,W),i.setAttribute(K,y),v=null,G=!1):1===Y?(h=e.touches[0].clientX,b=e.touches[0].clientY):Y>1&&(v=null)}),massAddEventListener(V,"wheel",function(e){if(n=this,i=this.children[0],A=n.getBoundingClientRect(),s=n.clientHeight,a=n.clientWidth,u=i.clientHeight,c=i.clientWidth,l=A.left,r=A.top,o=minMax(parseFloat(i.getAttribute(B),z,k)),d=parseFloat(i.getAttribute(O)),m=parseFloat(i.getAttribute(K)),x=e.clientX,S=e.clientY,D=e.deltaY<0?1:-1,(T=o+(F=X*D))<z||T>k)return!1;p=(c*T-a)/2,w=(u*T-s)/2,T<=1?(W=0,y=0):(W=c*T<=a?0:minMax(d-(x-l-a/2-d)/(T-F)*F,-1*p,p),y=u*T<=s?0:minMax(m-(S-r-s/2-m)/(T-F)*F,-1*w,w));T>1?addClass(n,N):removeClass(n,N);i.setAttribute(B,T),i.setAttribute(O,W),i.setAttribute(K,y),moveScaleElement(i,W+"px",y+"px",T)})}function addClass(e,t){!1===hasClass(e,t)&&(e.className+=" "+t)}function disableScroll(){window.addEventListener&&window.addEventListener("DOMMouseScroll",preventDefault,!1),window.addEventListener("mousewheel",preventDefault,{passive:!1}),window.addEventListener("wheel",preventDefault,{passive:!1}),document.addEventListener("mousewheel",preventDefault,{passive:!1}),window.addEventListener("touchmove",preventDefault,{passive:!1}),document.addEventListener("keydown",preventDefaultForScrollKeys,{passive:!1})}function enableScroll(){window.removeEventListener&&window.removeEventListener("DOMMouseScroll",preventDefault,!1),window.removeEventListener("mousewheel",preventDefault,!1),window.removeEventListener("wheel",preventDefault,!1),document.removeEventListener("mousewheel",preventDefault,!1),window.removeEventListener("touchmove",preventDefault,!1),document.removeEventListener("keydown",preventDefaultForScrollKeys,!1)}function isScrolling(){return window.lastScrollTime&&(new Date).getTime()<window.lastScrollTime+250}function isWithinRange(e,t,n){return e>=t&&e<=n}function hasClass(e,t){var n=new RegExp("(?:^|\\s)"+t+"(?!\\S)","g");return!!e.className.match(n)}function massAddEventListener(e,t,n,i){i=i||!1;for(var s=0;s<e.length;s++)e[s].addEventListener(t,n,i)}function minMax(e,t,n){return e<t?e=t:e>n&&(e=n),e}function moveScaleElement(e,t,n,i){e.style.cssText="-moz-transform : translate("+t+", "+n+") scale("+i+"); -ms-transform : translate("+t+", "+n+") scale("+i+"); -o-transform : translate("+t+", "+n+") scale("+i+"); -webkit-transform : translate("+t+", "+n+") scale("+i+"); transform : translate3d("+t+", "+n+", 0) scale3d("+i+", "+i+", 1);"}function preventDefault(e){(e=e||window.event).preventDefault&&e.preventDefault(),e.returnValue=!1}function preventDefaultForScrollKeys(e){if({37:1,38:1,39:1,40:1}[e.keyCode])return preventDefault(e),!1}function removeClass(e,t){var n=new RegExp("(?:^|\\s)"+t+"(?!\\S)","g");e.className=e.className.replace(n,"")}window.addEventListener("load",zoom);